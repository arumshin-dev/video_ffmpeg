# Start Here: Codebase Onboarding Guide

## 1. Codebase Structure
This project is a containerized web application split into a Frontend (UI) and Backend (API).

```
.
├── backend/                # FastAPI Application
│   ├── app/
│   │   ├── api/            # API Routes (Endpoints)
│   │   ├── core/           # Config & Logger
│   │   ├── services/       # Business Logic (Video, TTS, LLM)
│   │   └── main.py         # Entry Point
│   ├── Dockerfile          # Backend Image Definition
│   └── requirements.txt    # Server Dependencies
├── frontend/               # Streamlit Application
│   ├── app.py              # Main UI Logic
│   ├── Dockerfile          # Frontend Image Definition
│   └── requirements.txt    # UI Dependencies
├── assets/                 # Shared Resources (Fonts, BGM)
├── docker-compose.yml      # Service Orchestration
└── README.md               # Project Documentation
```

## 2. Key Things to Know
- **Dual Connectivity**: The Frontend talks to the Backend in two ways:
  1.  **Server-side (Docker Network)**: `requests.post("http://backend:8000/...")` sends data to generate the video.
  2.  **Client-side (Browser)**: `st.video("http://localhost:18000/...")` plays the result. The browser cannot see `backend:8000`.
- **FFmpeg & OpenCV**: The backend relies heavily on system-level libraries (`libglib`, `ffmpeg`). These are installed in the Dockerfile.
- **Assets**: The `assets/` folder is essential for fonts and BGM. It is copied into the backend container at `/app/assets`.

## 3. Future Learning
- **AsyncIO**: The backend uses `async/await` (FastAPI). Understanding event loops is helpful for scaling.
- **FFmpeg Filters**: The core video magic happens in complex filter chains ([zoompan](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/backend/app/services/video.py#85-116), [drawtext](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/backend/app/services/video.py#67-74), `sidechaincompress`). Studying FFmpeg filter syntax will help you customize effects.
- **Docker Networking**: Understanding how containers communicate (DNS, ports) is crucial for debugging connection issues.

---

## 4. Proposed Tasks
Here are 4 specific tasks to improve the codebase, ranging from simple fixes to structural improvements.

### Task 1: Fix Typo (Low Effort)
**Location**: [backend/app/services/video.py](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/backend/app/services/video.py) (Line 213)
**Issue**: The comment says `# ffmpeg에는 str로 넘거야 함` (should be "넘겨야").
**Action**: Correct the spelling to "넘겨야".

### Task 2: Fix Logic Bug (Medium Effort)
**Location**: [frontend/app.py](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/frontend/app.py)
**Issue**: The video playback URL is hardcoded (`http://localhost:18000`). This breaks if deployed to a cloud server or if the port changes.
**Action**: Introduce environment variables `INTERNAL_API_URL` (for requests) and `PUBLIC_API_URL` (for browser playback) to make the app portable.

### Task 3: Update Documentation (Low Effort)
**Location**: [README.md](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/README.md)
**Issue**: The installation guide says `pip install -r requirements.txt`. We recently split this into [backend/requirements.txt](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/backend/requirements.txt) and [frontend/requirements.txt](file:///e:/ai/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/CV_FFmpeg_AI_Shortform_Ad_Video_Maker-main/frontend/requirements.txt).
**Action**: Update the guide to reflect the new dependency structure.

### Task 4: Add Tests (High Effort)
**Location**: `backend/tests/test_api.py` (New File)
**Issue**: There are currently no automated tests.
**Action**: Create a simple test that starts the FastAPI client and checks if `GET /health` returns `200 OK`. This establishes a testing baseline.
